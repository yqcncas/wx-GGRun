(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["packageA/enter/enter"],{"0c79":function(e,n,t){"use strict";var o={"uni-popup":function(){return t.e("components/uni-popup/uni-popup").then(t.bind(null,"8626"))}},r=function(){var e=this,n=e.$createElement;e._self._c},a=[];t.d(n,"b",(function(){return r})),t.d(n,"c",(function(){return a})),t.d(n,"a",(function(){return o}))},"224f":function(e,n,t){"use strict";var o=t("33e3"),r=t.n(o);r.a},"33e3":function(e,n,t){},"3cfa":function(e,n,t){"use strict";(function(e){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var o=r(t("4795"));function r(e){return e&&e.__esModule?e:{default:e}}function a(e,n,t,o,r,a,i){try{var c=e[a](i),u=c.value}catch(s){return void t(s)}c.done?n(u):Promise.resolve(u).then(o,r)}function i(e){return function(){var n=this,t=arguments;return new Promise((function(o,r){var i=e.apply(n,t);function c(e){a(i,o,r,c,u,"next",e)}function u(e){a(i,o,r,c,u,"throw",e)}c(void 0)}))}}var c=function(){t.e("components/uni-popup/uni-popup").then(function(){return resolve(t("8626"))}.bind(null,t)).catch(t.oe)},u=t("3d41"),s={onLoad:function(){e.getStorageSync("user_phone")&&(this.phone=e.getStorageSync("user_phone")),e.getStorageSync("phoneLoginWay")&&(this.scrollIndex=1,e.removeStorageSync("phoneLoginWay"));var n=e.getSystemInfoSync();this.platform=n.platform,console.log("android"==this.platform)},components:{uniPopup:c},onHide:function(){e.setStorageSync("loginFlag",1)},onShow:function(){var n=e.getSystemInfoSync();this.platform=n.platform},data:function(){return{phone:"",pwd:"",scrollIndex:0,cid:"",uniId:"",nickName:"",avatarUrl:"",platform:"",code:"",openid:"",session_key:"",unionid:"",appId:"wx68da8cf05eb80bfb",getPhoneFlag:!1,userPhoneFlag:!1}},methods:{handleScrollList:function(e){this.scrollIndex=e,this.pwd=""},goToRegister:function(){e.navigateTo({url:"../../packageA/register/register"})},goToForgetPwd:function(){e.navigateTo({url:"../ChangePwd/changePwd?status=0"})},login:function(){var n=this;return i(o.default.mark((function t(){var r;return o.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(""!==n.phone.trim()&&""!==n.pwd.trim()){t.next=3;break}return e.showToast({icon:"none",title:"请先输入手机或密码"}),t.abrupt("return");case 3:return t.next=5,n.$fetch(n.$api.customerLogin,{loginName:n.phone,password:n.pwd,cid:""},"POST","Form");case 5:r=t.sent,n.resMsg=r.msg,0==r.code?(e.setStorageSync("token",r.data.token),e.showToast({icon:"success",title:"登录成功"}),setTimeout((function(){e.reLaunch({url:"../../packageA/storage/storage"})}),1500)):e.showToast({icon:"none",title:r.msg});case 8:case"end":return t.stop()}}),t)})))()},wxLogin:function(n){var t=this;return i(o.default.mark((function r(){return o.default.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(t.getPhoneFlag){r.next=2;break}return r.abrupt("return",e.showToast({icon:"none",title:"请先进行微信授权"}));case 2:e.showLoading({title:"正在登陆中..."}),t.userPhoneFlag=!0,e.login({provider:"weixin",success:function(){var r=i(o.default.mark((function r(a){var i,c,s,d;return o.default.wrap((function(o){while(1)switch(o.prev=o.next){case 0:return t.code=a.code,e.hideLoading(),o.next=4,t.$fetch(t.$api.newWxLogin,{userType:2,code:t.code},"POST","FORM");case 4:return i=o.sent,console.log(i),t.openid=i.data.openid,e.setStorageSync("openId",t.openid),t.session_key=i.data.session_key,c=new u(t.appId,t.session_key),s=c.decryptData(n.detail.encryptedData,n.detail.iv),o.next=13,t.$fetch(t.$api.userWxLogin,{mobile:s.phoneNumber,unionId:t.unionid},"POST","FORM");case 13:d=o.sent,0==d.code?(e.showToast({icon:"success",title:"登录成功"}),e.setStorageSync("token",d.data.token),setTimeout((function(){e.reLaunch({url:"../../packageA/storage/storage"})}),1500)):(e.showToast({icon:"none",title:"未绑定手机号"}),setTimeout((function(){e.navigateTo({url:"../register/register"})}),1500));case 15:case"end":return o.stop()}}),r)})));function a(e){return r.apply(this,arguments)}return a}()});case 5:case"end":return r.stop()}}),r)})))()},getInfo:function(n){var t=this;e.login({provider:"weixin",success:function(){var r=i(o.default.mark((function r(a){var i,c,s,d;return o.default.wrap((function(o){while(1)switch(o.prev=o.next){case 0:return t.code=a.code,e.hideLoading(),o.next=4,t.$fetch(t.$api.newWxLogin,{userType:2,code:t.code},"POST","FORM");case 4:i=o.sent,t.openid=i.data.openid,e.setStorageSync("openId",t.openid),t.session_key=i.data.session_key,c=new u(t.appId,t.session_key),s=c.decryptData(n.detail.encryptedData,n.detail.iv),d=s.unionId,t.unionid=d,t.unionid&&(t.getPhoneFlag=!0,e.showToast({icon:"success",title:"授权成功"}),t.$refs.popupPhone.open());case 13:case"end":return o.stop()}}),r)})));function a(e){return r.apply(this,arguments)}return a}()})}}};n.default=s}).call(this,t("543d")["default"])},"7f79":function(e,n,t){"use strict";t.r(n);var o=t("0c79"),r=t("811c");for(var a in r)"default"!==a&&function(e){t.d(n,e,(function(){return r[e]}))}(a);t("224f");var i,c=t("f0c5"),u=Object(c["a"])(r["default"],o["b"],o["c"],!1,null,null,null,!1,o["a"],i);n["default"]=u.exports},"811c":function(e,n,t){"use strict";t.r(n);var o=t("3cfa"),r=t.n(o);for(var a in o)"default"!==a&&function(e){t.d(n,e,(function(){return o[e]}))}(a);n["default"]=r.a},ed0b:function(e,n,t){"use strict";(function(e){t("297d");o(t("66fd"));var n=o(t("7f79"));function o(e){return e&&e.__esModule?e:{default:e}}e(n.default)}).call(this,t("543d")["createPage"])}},[["ed0b","common/runtime","common/vendor"]]]);